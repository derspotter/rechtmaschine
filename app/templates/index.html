<!DOCTYPE html>
<html>

<head>
    <title>Rechtmaschine - Document Classifier</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/styles.css">
</head>

<body>
    <div id="loginOverlay"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; display: flex; justify-content: center; align-items: center;">
        <div style="background: white; padding: 30px; border-radius: 8px; width: 300px; text-align: center;">
            <h2>Anmelden</h2>
            <input type="email" id="loginEmail" placeholder="E-Mail"
                style="width: 100%; padding: 10px; margin-bottom: 10px; box-sizing: border-box;">
            <input type="password" id="loginPassword" placeholder="Passwort"
                style="width: 100%; padding: 10px; margin-bottom: 20px; box-sizing: border-box;">
            <button class="btn" onclick="handleLogin()"
                style="width: 100%; background-color: #27ae60;">Einloggen</button>
            <p id="loginError" style="color: red; margin-top: 10px; display: none;"></p>
        </div>
    </div>

    <div class="header">
        <h1>ğŸ›ï¸ Rechtmaschine</h1>

        <button class="btn btn-danger" data-reset-button onclick="resetApplication(event)" style="margin-top: 15px;">
            ğŸ§¹ Alles zurÃ¼cksetzen
        </button>
    </div>

    <div class="categories-grid" style="margin-bottom: 30px;">
        <!-- Box 1: Klassifikation -->
        <div class="category-box classify">
            <div class="category-header">
                <h3 style="margin: 0;">ğŸ“¤ Klassifikation</h3>
            </div>
            <p style="color: #7f8c8d; font-size: 14px; margin-bottom: 15px;">
                Laden Sie ein PDF-Dokument hoch, um es zu analysieren und automatisch einzuordnen.
            </p>
            <input type="file" id="fileInput" accept=".pdf" style="width: 100%; margin-bottom: 15px;" />
            <button class="btn" onclick="uploadFile()" style="width: 100%; background-color: #16a085;">Dokument
                klassifizieren</button>
            <div class="loading" id="loading">â³ Dokument wird analysiert...</div>
        </div>

        <!-- Box 2: Recherche -->
        <div class="category-box research-box">
            <div class="category-header">
                <h3 style="margin: 0;">ğŸ” Recherche</h3>
            </div>
            <textarea id="outputDescription" placeholder="Frage eingeben (z.B. 'Abschiebungsverbot Afghanistan')"
                style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #bdc3c7; border-radius: 5px; font-family: Arial; margin-bottom: 10px; resize: vertical;"></textarea>

            <div style="margin-bottom: 10px;">
                <label for="asylnetKeywords" style="font-weight: 600; color: #2c3e50; font-size: 13px;">asyl.net Suche
                    (Optional):</label>
                <input type="text" id="asylnetKeywords" list="asylnetSuggestions"
                    placeholder="SchlagwÃ¶rter (z.B. Syrien)"
                    style="width: 100%; padding: 6px 10px; border: 1px solid #bdc3c7; border-radius: 5px; margin-top: 2px;">
                <datalist id="asylnetSuggestions"></datalist>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="researchDocumentSelect"
                    style="font-weight: 600; color: #2c3e50; font-size: 13px;">Referenzdokument (Optional):</label>
                <select id="researchDocumentSelect"
                    style="width: 100%; padding: 6px; border: 1px solid #bdc3c7; border-radius: 5px; margin-top: 2px;">
                    <option value="">Kein Dokument (oder Hauptbescheid nutzen)</option>
                </select>
                <p style="font-size: 11px; color: #7f8c8d; margin-top: 2px; margin-bottom: 0;">WÃ¤hlen Sie ein Dokument
                    als Basis fÃ¼r die Recherche (z.B. Urteil).</p>
            </div>

            <div style="margin-bottom: 15px;">
                <label for="searchEngineSelect"
                    style="font-weight: 600; color: #2c3e50; font-size: 13px;">Suchmaschine:</label>
                <select id="searchEngineSelect"
                    style="width: 100%; padding: 6px; border: 1px solid #bdc3c7; border-radius: 5px; margin-top: 2px;">
                    <option value="meta" selected>âœ¨ Meta-Suche (Smart Aggregation)</option>
                    <option value="gemini">Gemini (Standard)</option>
                    <option value="grok-4-1-fast">Grok 4.1 Fast</option>
                </select>
            </div>

            <button class="btn" onclick="generateDocument()" style="background-color: #c0392b; width: 100%;">
                Recherche starten
            </button>
            <div class="loading" id="researchLoading">â³ Recherche lÃ¤uft...</div>
        </div>

        <!-- Box 3: Generierung -->
        <div class="category-box generate">
            <div class="category-header">
                <h3 style="margin: 0;">âœï¸ Entwurf</h3>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="documentTypeSelect"
                    style="font-weight: 600; color: #2c3e50; font-size: 13px;">Dokumententyp:</label>
                <select id="documentTypeSelect"
                    style="width: 100%; padding: 6px; border: 1px solid #bdc3c7; border-radius: 5px; margin-top: 2px;">
                    <option value="KlagebegrÃ¼ndung">KlagebegrÃ¼ndung</option>
                    <option value="Antrag auf Zulassung der Berufung (AZB)">Antrag auf Zulassung der Berufung (AZB)
                    </option>
                    <option value="Schriftsatz">Schriftsatz</option>
                </select>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="draftInstructions"
                    style="font-weight: 600; color: #2c3e50; font-size: 13px;">Anweisungen:</label>
                <textarea id="draftInstructions"
                    placeholder="Spezifische Anweisungen fÃ¼r den Entwurf (z.B. 'Fokus auf PTSD', 'Mandant ist minderjÃ¤hrig')"
                    style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #bdc3c7; border-radius: 5px; font-family: Arial; margin-top: 2px; resize: vertical;"></textarea>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="modelSelect" style="font-weight: 600; color: #2c3e50; font-size: 13px;">KI-Modell:</label>
                <select id="modelSelect"
                    style="width: 100%; padding: 6px; border: 1px solid #bdc3c7; border-radius: 5px; margin-top: 2px;">
                    <option value="claude-opus-4-5" selected>Claude Opus 4.5</option>
                    <option value="gpt-5.2">GPT-5.2 (Reasoning)</option>
                    <option value="gemini-3-pro-preview">Gemini 3 Pro</option>
                    <option value="multi-step-expert">Multi-Step Expert</option>
                </select>
            </div>

            <div id="verbosityGroup" style="display: none; margin-bottom: 15px;">
                <label for="verbositySelect"
                    style="font-weight: 600; color: #2c3e50; font-size: 13px;">AusfÃ¼hrlichkeit:</label>
                <select id="verbositySelect"
                    style="width: 100%; padding: 6px; border: 1px solid #bdc3c7; border-radius: 5px; margin-top: 2px;">
                    <option value="high" selected>High (Sehr ausfÃ¼hrlich)</option>
                    <option value="medium">Medium</option>
                    <option value="low">Low</option>
                </select>
            </div>

            <button class="btn" onclick="createDraft()"
                style="background-color: #2c3e50; width: 100%; margin-top: 10px;">
                Entwurf generieren
            </button>
        </div>
    </div>

    <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">Dokumente</h2>
    <div class="categories-grid">
        <div class="category-box anhoerung">
            <div class="category-header">
                <h3>ğŸ“‹ AnhÃ¶rung</h3>
                <button class="btn-add-doc" onclick="triggerDirectUpload('AnhÃ¶rung')"
                    title="Dokument direkt hochladen">+</button>
                <input type="file" id="file-anhoerung" accept=".pdf" style="display: none;"
                    onchange="uploadDirectFile('AnhÃ¶rung', this)">
            </div>
            <div id="anhoerung-docs"></div>
        </div>
        <div class="category-box bescheid">
            <div class="category-header">
                <h3>ğŸ“„ Bescheid</h3>
                <button class="btn-add-doc" onclick="triggerDirectUpload('Bescheid')"
                    title="Dokument direkt hochladen">+</button>
                <input type="file" id="file-bescheid" accept=".pdf" style="display: none;"
                    onchange="uploadDirectFile('Bescheid', this)">
            </div>
            <div id="bescheid-docs"></div>
        </div>
        <div class="category-box vorinstanz">
            <div class="category-header">
                <h3>ğŸ›ï¸ Vorinstanz</h3>
                <button class="btn-add-doc" onclick="triggerDirectUpload('Vorinstanz')"
                    title="Dokument direkt hochladen">+</button>
                <input type="file" id="file-vorinstanz" accept=".pdf" multiple style="display: none;"
                    onchange="uploadDirectFile('Vorinstanz', this)">
            </div>
            <div style="display: flex; justify-content: flex-end; gap: 8px; margin-bottom: 8px; padding-right: 10px;">
                <button class="btn" onclick="selectAllVorinstanz()"
                    style="padding: 4px 8px; font-size: 11px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">âœ…
                    Alle auswÃ¤hlen</button>
            </div>
            <div id="vorinstanz-docs"></div>
        </div>
        <div class="category-box akte">
            <div class="category-header">
                <h3>ğŸ“š Akte</h3>
                <button class="btn-add-doc" onclick="triggerDirectUpload('Akte')"
                    title="Dokument direkt hochladen">+</button>
                <input type="file" id="file-akte" accept=".pdf" style="display: none;"
                    onchange="uploadDirectFile('Akte', this)">
            </div>
            <div id="akte-docs"></div>
        </div>
        <div class="category-box rechtsprechung">
            <div class="category-header">
                <h3>âš–ï¸ Rechtsprechung</h3>
                <button class="btn-add-doc" onclick="triggerDirectUpload('Rechtsprechung')"
                    title="Dokument direkt hochladen">+</button>
                <input type="file" id="file-rechtsprechung" accept=".pdf" style="display: none;"
                    onchange="uploadDirectFile('Rechtsprechung', this)">
            </div>
            <div id="rechtsprechung-docs"></div>
        </div>
        <div class="category-box sonstiges">
            <div class="category-header">
                <h3>ğŸ“‚ Sonstiges</h3>
                <button class="btn-add-doc" onclick="triggerDirectUpload('Sonstiges')"
                    title="Dokument direkt hochladen">+</button>
                <input type="file" id="file-sonstiges" accept=".pdf" style="display: none;"
                    onchange="uploadDirectFile('Sonstiges', this)">
            </div>
            <div id="sonstiges-docs"></div>
        </div>
        <div class="category-box sources">
            <div class="category-header">
                <h3>ğŸ”— Gespeicherte Quellen</h3>
            </div>
            <div style="display: flex; justify-content: flex-end; gap: 8px; margin-bottom: 8px;">
                <button class="btn" onclick="selectAllSources()"
                    style="padding: 6px 10px; font-size: 12px; background-color: #3498db;">âœ… Alle auswÃ¤hlen</button>
            </div>
            <div id="sources-docs"></div>
        </div>
    </div>

    <script src="/static/js/marked.min.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>